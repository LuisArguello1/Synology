<!--
    BASE LAYOUT - Plantilla base del sistema
    
    Este template integra todos los componentes reutilizables:
    - Sidebar
    - Navbar
    - Footer
    - Alerts
    - Scripts
    
    Bloques disponibles para extender:
    - title: Título de la página (<title>)
    - extra_css: CSS adicional específico de página
    - content: Contenido principal de la página
    - extra_js: JavaScript adicional específico de página
    
    Contexto esperado por los componentes:
    - menu_items: Para el sidebar
    - breadcrumbs: Para el navbar (opcional)
    - page_title: Título de la página (opcional)
    - user: Usuario autenticado (Django lo provee automáticamente)
    
    Uso en templates hijos:
    {# extends 'layouts/base.html' #}
    
    {# block title #}Mi Página{# endblock #}
    
    {# block content #}
        <h1>Contenido aquí</h1>
    {# endblock #}
-->
{% load static %}
<!DOCTYPE html>
<html lang="es" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    
    <!-- Title -->
    <title>{% block title %}Dashboard{% endblock %} | NAS Manager</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/static/icons/favicon.ico">
    <link rel="shortcut icon" type="image/x-icon" href="/static/icons/favicon.ico">
    
    <!-- PWA -->
    <link rel="manifest" href="/static/manifest.json">
    <meta name="theme-color" content="#2563eb">
    <link rel="apple-touch-icon" href="/static/icons/apple-touch-icon.png">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{% static 'css/message.css' %}">
    <link rel="stylesheet" href="{% static 'css/sidebar.css' %}">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts (Inter - tipografía profesional) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- SweetAlert2 para modales elegantes -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- Block para CSS adicional -->
    {% block extra_css %}{% endblock %}
    
    <style>
        /* Tipografía base */
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        [x-cloak] { 
            display: none !important; 
        }

        
        /* Scrollbar personalizada */
        .scrollbar-thin::-webkit-scrollbar {
            width: 6px;
        }
        .scrollbar-thin::-webkit-scrollbar-track {
            background: #1f2937;
        }
        .scrollbar-thin::-webkit-scrollbar-thumb {
            background: #4b5563;
            border-radius: 3px;
        }
        .scrollbar-thin::-webkit-scrollbar-thumb:hover {
            background: #6b7280;
        }
    </style>
</head>
<body class="h-full bg-gray-50 antialiased">
    
    <!-- Floating Icon for Minimized Mode -->
    <div id="sidebar-floating-icon" class="sidebar-floating-icon" aria-hidden="true" role="button" aria-label="Restaurar barra lateral" tabindex="0">
        <i class="fas fa-bars text-xl"></i>
    </div>

    <!-- Mobile OverlayBackdrop -->
    <div id="sidebar-overlay" class="fixed inset-0 bg-black/50 z-40 hidden transition-opacity duration-300 opacity-0" aria-hidden="true"></div>

    <!-- Sidebar -->
    {% include 'partials/sidebar.html' with menu_items=menu_items %}
    
    <!-- Área de contenido principal -->
    <div id="main-layout">
        
        <!-- Navbar -->
        {% include 'components/navbar.html' with page_title=page_title breadcrumbs=breadcrumbs %}
        
        <!-- Contenido principal -->
        {% block layout_content %}
        <main class="w-full">
            <div class="container mx-auto px-6 py-6 h-full">
                
                <!-- Mensajes de Django -->
                {% include 'fragments/alerts.html' %}
                
                <!-- Contenido de la página -->
                {% block content %}
                    <!-- El contenido de cada página va aquí -->
                {% endblock %}
                
                </div>
        </main>
        {% endblock %}
        
    </div>
    
    <!-- Scripts globales -->
    {% include 'partials/scripts.html' %}
    
    <!-- Sidebar Controller -->
    <script type="module" src="{% static 'js/sidebar.js' %}"></script>
    
    <!-- Block para JS adicional -->
    {% block extra_js %}{% endblock %}

    <!-- PWA Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/static/sw.js')
                    .then(reg => console.log('SW Registered'))
                    .catch(err => console.log('SW Registration Failed', err));
            });
        }
    </script>
    
</body>
</html>
